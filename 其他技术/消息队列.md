# 消息队列

解决的问题是：生产者和消费者的通信问题

### 同步和异步

同步就是发出一个调用时，没有得到结果之前，该调用就不返回；

异步就是调用在发出之后就直接返回了，所以没有返回结果。调用者不会立即得到结果，而是之后被调用者通过状态、信号通知调用者，或者通过回调函数处理这个调用。

### 阻塞和非阻塞

在进程通信层面， 阻塞/非阻塞， 同步/异步基本是同义词， 但是需要注意区分讨论的对象是发送方还是接收方。

发送方阻塞/非阻塞（同步/异步）和接收方的阻塞/非阻塞（同步/异步） 是互不影响的。

在 IO 系统调用层面（ IO system call ）层面， **非阻塞 IO 系统调用** 和 **异步 IO 系统调用**存在着一定的差别， 它们都不会阻塞进程， 但是返回结果的方式和内容有所差别， 但是都属于非阻塞系统调用（ non-blocing system call 

### 模型的进化

- 原始模型
- 发布-订阅模型

### 消息队列MQ的优势

- 系统解耦
- 异步通信
- 流量削峰

```
支付订单的例子中，订单系统只需要关注最重要的流程：更改订单状态，而例如更新用户积分，通知商家，更新用户画像等全部交给MQ，实现了系统解耦；  同时这些步骤变成了异步执行，能减少订单的整体耗时，提升订单系统的吞吐量；   对于超出系统承载能力的场景，队列能转储消息，进行限流保护，即流量削峰
```

### 如何设计一个MQ